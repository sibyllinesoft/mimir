# Mimir Deep Code Research System - Environment Configuration
# Copy this file to .env and customize for your environment

# ============================================================================
# CORE APPLICATION SETTINGS
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
MIMIR_LOG_LEVEL=INFO

# Maximum number of concurrent workers for pipeline processing
MIMIR_MAX_WORKERS=4

# Request timeout in seconds
MIMIR_TIMEOUT=300

# Maximum memory usage per worker in MB
MIMIR_MAX_MEMORY_MB=1024

# ============================================================================
# STORAGE CONFIGURATION
# ============================================================================

# Data persistence paths (absolute paths for production)
MIMIR_DATA_PATH=./data
MIMIR_CACHE_PATH=./cache
MIMIR_LOGS_PATH=./logs

# Storage directory inside container
MIMIR_STORAGE_DIR=/app/data
MIMIR_CACHE_DIR=/app/cache

# ============================================================================
# UI CONFIGURATION
# ============================================================================

# UI service host and port
MIMIR_UI_HOST=0.0.0.0
MIMIR_UI_PORT=8000

# Reverse proxy settings (for production)
MIMIR_UI_BEHIND_PROXY=false
MIMIR_UI_PROXY_HEADERS=false

# ============================================================================
# MONITORING & METRICS
# ============================================================================

# Enable Prometheus metrics endpoint
MIMIR_ENABLE_METRICS=false
MIMIR_METRICS_PORT=9100

# Enable performance profiling (development only)
MIMIR_ENABLE_PROFILING=false

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# API key for authenticated access (production)
# MIMIR_API_KEY=your-secure-api-key-here

# JWT secret for session management (if using authentication)
# MIMIR_JWT_SECRET=your-jwt-secret-here

# CORS settings for UI
MIMIR_CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ============================================================================
# DATABASE & CACHING
# ============================================================================

# Redis connection (if using external Redis)
# REDIS_URL=redis://localhost:6379/0
# REDIS_PASSWORD=your-redis-password

# Database URL (if using external database for metadata)
# DATABASE_URL=postgresql://user:password@localhost:5432/mimir

# ============================================================================
# EXTERNAL SERVICES
# ============================================================================

# Git service configuration
GIT_DEFAULT_BRANCH=main
GIT_CLONE_TIMEOUT=300

# Tree-sitter parser configuration
TREE_SITTER_LANGUAGES=typescript,javascript,python,rust,go,java

# Vector embedding service (if using external service)
# EMBEDDING_SERVICE_URL=http://localhost:8080
# EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2

# ============================================================================
# PIPELINE CONFIGURATION
# ============================================================================

# Enable/disable specific pipeline stages
PIPELINE_ENABLE_ACQUIRE=true
PIPELINE_ENABLE_REPOMAPPER=true
PIPELINE_ENABLE_SERENA=true
PIPELINE_ENABLE_LEANN=true
PIPELINE_ENABLE_SNIPPETS=true
PIPELINE_ENABLE_BUNDLE=true

# Pipeline stage timeouts (seconds)
PIPELINE_TIMEOUT_ACQUIRE=60
PIPELINE_TIMEOUT_REPOMAPPER=120
PIPELINE_TIMEOUT_SERENA=180
PIPELINE_TIMEOUT_LEANN=240
PIPELINE_TIMEOUT_SNIPPETS=60
PIPELINE_TIMEOUT_BUNDLE=30

# Maximum file size for processing (MB)
PIPELINE_MAX_FILE_SIZE=10

# Maximum repository size for processing (MB)
PIPELINE_MAX_REPO_SIZE=1000

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Async I/O configuration
ASYNCIO_MAX_WORKERS=10
ASYNCIO_SEMAPHORE_LIMIT=20

# Memory management
PYTHON_GC_THRESHOLD=700,10,10
PYTHON_MALLOC_STATS=0

# File I/O buffer sizes
FILE_READ_BUFFER_SIZE=8192
FILE_WRITE_BUFFER_SIZE=8192

# ============================================================================
# MONITORING & ALERTING
# ============================================================================

# Prometheus configuration
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVALUATION_INTERVAL=15s

# Grafana admin password (change for production!)
GRAFANA_ADMIN_PASSWORD=admin

# Health check configuration
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3

# ============================================================================
# DEVELOPMENT SETTINGS
# ============================================================================

# Development mode settings (set to false in production)
MIMIR_DEBUG=false
MIMIR_RELOAD=false

# Testing configuration
PYTEST_TIMEOUT=60
PYTEST_ASYNCIO_MODE=auto

# ============================================================================
# CONTAINER ORCHESTRATION
# ============================================================================

# Docker resource limits
DOCKER_MEMORY_LIMIT=2g
DOCKER_CPU_LIMIT=2.0
DOCKER_MEMORY_RESERVATION=512m
DOCKER_CPU_RESERVATION=0.5

# Network configuration
DOCKER_NETWORK_SUBNET=172.20.0.0/16

# ============================================================================
# SSL/TLS CONFIGURATION (Production)
# ============================================================================

# SSL certificate paths (for HTTPS)
# SSL_CERT_PATH=/etc/ssl/certs/mimir.crt
# SSL_KEY_PATH=/etc/ssl/private/mimir.key
# SSL_CA_PATH=/etc/ssl/certs/ca.crt

# TLS version and ciphers
# TLS_MIN_VERSION=1.2
# TLS_CIPHERS=ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS

# ============================================================================
# BACKUP & RECOVERY
# ============================================================================

# Backup configuration
# BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
# BACKUP_RETENTION_DAYS=30
# BACKUP_S3_BUCKET=mimir-backups
# BACKUP_S3_REGION=us-east-1

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log format: json, text
LOG_FORMAT=json

# Log rotation
LOG_MAX_SIZE=50m
LOG_MAX_FILES=10

# Structured logging fields
LOG_INCLUDE_TIMESTAMP=true
LOG_INCLUDE_LEVEL=true
LOG_INCLUDE_LOGGER=true
LOG_INCLUDE_THREAD=false